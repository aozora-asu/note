import{d as A,t as S,M as k,K as E,z as v,D as I,o as b,b as x,f as K}from"../modules/vue-D4ODiTOc.js";import{r as C,ad as q,ae as M,C as N,af as B,ag as D}from"../index-CLWVWuVS.js";import{u as P}from"./context-B8SV9QcE.js";function R(l,e){if(!e||e==="all"||e==="*")return C(1,l+1);if(e==="none")return[];const s=[];for(const t of e.split(/[,;]/g))if(!t.includes("-"))s.push(+t);else{const[r,a]=t.split("-",2);s.push(...C(+r,a?+a+1:l+1))}return q(s).filter(t=>t<=l).sort((t,r)=>t-r)}const $=A({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(l){const e=l,{$clicksContext:s}=P(),t=S(),r=M();return k(()=>{s.unregister(r)}),E(()=>{var h;if(!s||!((h=e.ranges)!=null&&h.length))return;const a=s.calculateSince(e.at,e.ranges.length-1);s.register(r,a);const u=v(()=>a?Math.max(0,s.current-a.start+1):N),p=v(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());I(()=>{if(!t.value)return;let f=e.ranges[u.value]??p.value;const d=f==="hide";t.value.classList.toggle(B,d),d&&(f=e.ranges[u.value+1]??p.value);const m=t.value.querySelectorAll(".mtable > [class*=col-align]");if(!m)return;const L=Array.from(m).map(i=>Array.from(i.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),o=[];for(const i of L)i.forEach((c,n)=>{c&&(Array.isArray(o[n])?o[n].push(c):o[n]=[c])});const y=e.startLine,_=R(o.length+y-1,f);o.forEach((i,c)=>{const n=_.includes(c+y);i.forEach(g=>{g.classList.toggle(D,!0),g.classList.toggle("highlighted",n),g.classList.toggle("dishonored",!n)})})})}),(a,u)=>(b(),x("div",{ref_key:"el",ref:t,class:"slidev-katex-wrapper"},[K(a.$slots,"default")],512))}});export{$ as _};
